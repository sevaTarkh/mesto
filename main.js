(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._img=e.link,this._templateSelector=t,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._elementFoto=this._element.querySelector(".element__image"),this._elementTitle=this._element.querySelector(".element__title"),this._elementLikeButton=this._element.querySelector(".element__button-like"),this._elementDeleteButton=this._element.querySelector(".element__button-delete"),this._setEventListeners(),this._elementFoto.src=this._img,this._elementTitle.textContent=this._name,this._elementFoto.alt=this._name,this._element}_toggleLike(e){e.target.classList.toggle("element_is-active")}_deleteCard=()=>{this._element.remove()};_setEventListeners(){this._elementLikeButton.addEventListener("click",(e=>{this._toggleLike(e)})),this._elementDeleteButton.addEventListener("click",(e=>{this._deleteCard(e)})),this._elementFoto.addEventListener("click",(()=>{this._handleImageClick(this._img,this._name)}))}}const t={formSelector:".popup__form",inputSelector:".popup__field",submitButtonSelector:".popup__button-submit",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__field_type_error",errorClass:"popup__error_visible"};class s{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputs=[...this._formElement.querySelectorAll(this._inputSelector)],this._button=this._formElement.querySelector(this._submitButtonSelector)}_removeError=(e,t)=>{e.classList.remove(this._errorClass),t.classList.remove(this._inputErrorClass),e.textContent=""};_addError=(e,t)=>{e.classList.add(this._errorClass),t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage};_enableButton(){this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=""}_disableButton(){this._button.classList.add(this._inactiveButtonClass),this._button.disabled="disabled"}_checkInputValidity=function(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.validity.valid?this._removeError(t,e):this._addError(t,e)};toggleButtonState=()=>{this._inputs.every((e=>e.validity.valid))?this._enableButton():this._disableButton()};resetValidation=()=>{this.toggleButtonState(),this._inputs.forEach((e=>{const t=this._formElement.querySelector(`#${e.id}-error`);this._removeError(t,e)}))};_setEventListeners(){this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation=()=>{this._setEventListeners()}}class o{constructor(e){this._selector=document.querySelector(e)}open(){this._selector.classList.add("popup_is-opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._selector.classList.remove("popup_is-opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._selector.querySelector(".popup__button-close").addEventListener("click",(()=>{this.close()})),this._selector.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class n extends o{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._selector.querySelector(".popup__form"),this._inputList=this._formElement.querySelectorAll(".popup__field")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._formElement.reset()}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),console.log(this._getInputValues()),this._handleFormSubmit(this._getInputValues()),this.close()}))}}document.querySelector(".popup_type_edit"),document.querySelector(".popup_type_add"),document.querySelector(".popup_type_foto");const r=document.querySelector(".profile__button-edit"),i=document.querySelector(".popup__field_theme_name"),l=document.querySelector(".popup__field_theme_about"),_=document.querySelector(".popup__form_theme_edit"),a=document.querySelector(".profile__button-add"),u=document.querySelector(".popup__form_theme_add"),c=(document.querySelector(".elements"),new s(t,_)),p=new s(t,u),d=new s(t,_),m=new s(t,u),h=new class extends o{constructor(e){super(e),this._popupFoto=this._selector.querySelector(".popup__foto"),this._popupFotoTitle=this._selector.querySelector(".popup__foto-title")}open(e,t){this._popupFoto.src=e,this._popupFotoTitle.textContent=t,this._popupFoto.alt=t,super.open()}}(".popup_type_foto"),v=new o(".popup_type_add"),y=new o(".popup_type_edit"),E=new class{constructor({selectorName:e,selectorAbout:t}){this._name=document.querySelector(e),this._about=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){this._name.textContent=e["name-author"],this._about.textContent=e["about-author"]}}({selectorName:".profile__title",selectorAbout:".profile__subtitle"});function f(e,t){h.setEventListeners(),h.open(e,t)}const S=t=>new e(t,"#element-template",f).generateCard(),b=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>b.addItem(S(e))},".elements");b.renderItems();const g=new n(".popup_type_add",(e=>{console.log(e);const t={name:e["name-foto"],link:e.link};b.addItem(S(t))})),L=new n(".popup_type_edit",(e=>{E.setUserInfo(e)}));a.addEventListener("click",(function(){v.open(),u.reset(),m.resetValidation()})),r.addEventListener("click",(function(){const{name:e,about:t}=E.getUserInfo();i.value=e,l.value=t,d.resetValidation(),y.open()})),c.enableValidation(),p.enableValidation(),v.setEventListeners(),y.setEventListeners(),L.setEventListeners(),g.setEventListeners()})();